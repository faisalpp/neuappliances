import{p as se,q as n,V as ae,r as a,u as le,j as t,bo as re,av as w,f as k,aV as ie,bM as oe,bL as ne,an as ce,w as j}from"./index-85fc7955.js";import{I as ue}from"./admin-1d3e9f4e.js";import{e as de}from"./category-4478a33e.js";import{B as me}from"./BlogEditor-407a84bc.js";const he=()=>{const U=se().shape({id:n().required("Id is required"),title:n().required("Title is required"),slug:n().required("Slug is required"),thumbnail:n().nullable(!0),tempImg:n().nullable(!0),category:n().required("Blog Category is required"),content:n().required("Blog Content is required")}),L=ae(),[u,S]=a.useState([]),[O,V]=a.useState([]),v=a.useRef(),$=le(),[G,d]=a.useState(!1),[N,H]=a.useState(),[m,C]=a.useState(""),[g,T]=a.useState(""),[i,q]=a.useState(""),[B,J]=a.useState(""),[I,P]=a.useState(""),[x,D]=a.useState(""),[f,E]=a.useState(""),[W,_]=a.useState(!1),[K,M]=a.useState(""),[R,A]=a.useState(""),[l,p]=a.useState([]),[h,F]=a.useState(""),b=a.useRef(),z=s=>{s.key===" "&&h.length>0&&(p([...l,h]),setTimeout(()=>{var e;F(""),(e=b.current)==null||e.focus(),b.current.setSelectionRange(0,0)},0))},Q=(s,e)=>{s.preventDefault();const r=l.filter((o,c)=>c!==e);p(r)};a.useEffect(()=>{X()},[]);const X=async()=>{const s={slug:L.slug},e=await de(s);if(e.status===200){H(e.data.blog._id),C(e.data.blog.title),T(e.data.blog.slug),E(e.data.blog.content),D(e.data.blog.category),q(e.data.blog.thumbnail),M(e.data.blog.metaTitle),A(e.data.blog.metaDescription);let r=e.data.blog.metaKeywords;p(JSON.parse(r));const o=e.data.categories.filter(te=>te.slug!==x),y=[{title:e.data.blog.category.replace(/\-/g," "),slug:e.data.blog.category},...o];V(y)}},Y=async s=>{s.preventDefault(),d(!0);try{const o={id:N,title:m,slug:g,thumbnail:i,tempImg:B,category:x,content:f};await U.validate(o,{abortEarly:!1})}catch(o){if(d(!1),o){let c=o.errors;S(c),c.forEach(y=>{j(y,"error",1e3)})}else S([])}const e=new FormData;e.set("id",N),e.set("title",m),e.set("slug",g),e.set("thumbnail",i),e.set("tempImg",B),e.set("category",x),e.set("metaTitle",K),e.set("content",f),e.set("metaDescription",R),e.set("metaKeywords",JSON.stringify(l)),e.set("isImg",W);const r=await ue(e);r.status===200?(j(r.data.msg,"success",1e3),$("/admin/manage-blogs")):(d(!1),j(r.data.message,"error",1e3))},Z=s=>{s.preventDefault();const e=s.target.files[0];e&&(P(window.URL.createObjectURL(e)),J(i),q(e),_(!0))},ee=()=>{v.current.click()};return t.jsx(t.Fragment,{children:t.jsx(re,{children:t.jsxs("form",{onSubmit:Y,className:"flex flex-col space-y-5 w-full py-5 bg-white",children:[t.jsxs("div",{className:"flex w-full",children:[t.jsxs("div",{className:"flex flex-col space-y-10 w-1/2",children:[t.jsx(w,{width:"full",name:"title",title:"Blog Title",iscompulsory:"true",type:"text",value:m,onChange:s=>{C(s.target.value),T(s.target.value.toLowerCase().replace(/\s/g,"-").replace(/\./g,""))},error:!!(u&&u.includes("Title is required")),errormessage:"Title is required",placeholder:"Enter Blog Title"}),t.jsx(w,{width:"full",name:"slug",title:"Blog Slug",readOnly:!0,iscompulsory:"true",type:"text",value:g,error:!!(u&&u.includes("Slug is required")),errormessage:"Slug is required",placeholder:"Enter Blog Slug"})]}),t.jsxs("div",{className:"flex flex-col space-y-8 items-center w-1/2",children:[t.jsxs("div",{className:"flex flex-col space-y-2",children:[t.jsx("img",{src:(i==null?void 0:i.length)>0?i:I.length>0?I:"/no-image.jfif",className:`self-center rounded-xl ${i?"h-36 w-36":"h-26 w-32"}`}),t.jsx("button",{onClick:ee,type:"button",className:"flex justify-center items-center self-center cursor-pointer rounded-md py-1 w-fit bg-b3",children:t.jsxs("a",{className:"flex items-center text-center  w-fit px-4 py-1 rounded-md text-white font-semibold",children:[t.jsx("span",{className:"text-xs",children:"Select Thumbnail"}),t.jsx(k,{className:"text-2xl"})]})}),t.jsx("input",{ref:v,name:"thumbnail",type:"file",className:"hidden",onChange:s=>Z(s)})]}),t.jsx("div",{className:"flex justify-center space-x-5 w-full",children:t.jsx(ie,{name:"categor",title:"Select Blog Category",iscompulsory:"true",onChange:s=>D(s.target.value),options:O})})]})]}),t.jsx(me,{state:f,setState:E}),t.jsx(oe,{title:"Blog Seo",answer:t.jsxs("div",{className:"flex flex-col space-y-2 w-full",children:[t.jsx(w,{width:"full",name:"title",title:"Meta Title",type:"text",value:K,onChange:s=>M(s.target.value),placeholder:"Enter Meta Title"}),t.jsx(ne,{width:"full",title:"Meta Description",value:R,onChange:s=>A(s.target.value),placeholder:"Write Meta Description Here.."}),t.jsx("h5",{className:"text-xs font-semibold",children:"Meta Keywords"}),t.jsx("div",{className:"flex flex-wrap w-full py-3 px-2 rounded-xl border-[1px] borders-[0,0,0,0,0.15]",children:t.jsxs("div",{className:"flex flex-wrap gap-y-2 items-center gap-x-2 w-full h-auto ",children:[(l==null?void 0:l.length)>0?l==null?void 0:l.map((s,e)=>t.jsxs("span",{className:"flex items-center bg-b6 text-sm px-2 py-1 text-white rounded-2xl",children:[s,t.jsx(ce,{onClick:r=>Q(r,e),className:"text-white bg-red-500 ml-1 text-xs cursor-pointer rounded-full"})]},e)):null,t.jsx("div",{}),t.jsx("input",{ref:b,placeholder:"Hit Space To Insert",value:h,onKeyDown:s=>z(s),onChange:s=>F(s.target.value),className:"border-none outline-none mx-5 text-sm"})]})})]}),parent:"w-full [&>div]:py-4 [&>div]:px-6 [&>div]:border [&>div]:border-b33 [&>div]:rounded-xl h-auto border-0",icon:"text-xl",textStyle:"font-bold text-sm",child:"justify-center w-full [&>p]:text-sm !mt-0"}),t.jsx("button",{type:"submit",className:"flex justify-center items-center cursor-pointer rounded-md py-1 w-full bg-b3",children:G?t.jsx("img",{src:"/loader-bg.gif",className:"w-8"}):t.jsxs("a",{className:"flex items-center text-center  w-fit px-4 py-1 rounded-md text-white font-semibold",children:[t.jsx("span",{className:"text-xs",children:"Update"}),t.jsx(k,{className:"text-2xl"})]})})]})})})};export{he as default};
