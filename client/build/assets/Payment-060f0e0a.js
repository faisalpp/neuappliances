import{R as f,r as p,j as r,D as De,u as $e,e as Me,f as w,L as Fe,T as fe}from"./index-55b4072e.js";import{C as We,B as Ke,L as Ye}from"./LeftArrowSvg-c0c39cb8.js";import{R as Z}from"./ReviewDetail-55985367.js";import{P as c,an as ze,r as I,A as Ge}from"./ScrollToTop-80fa92ab.js";import{m as we,v as He}from"./MainLayout-cc45fb5d.js";import{T as R}from"./TextInput-1635d03b.js";import{C as he}from"./CustomSelect-9d8b23ac.js";import{c as xe,a as b}from"./index.esm-9ac6aab9.js";import"./CustomInput-ffef89be.js";import"./index.esm-88a0f635.js";import"./index-beadc3fe.js";function ye(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(a,o).enumerable})),t.push.apply(t,n)}return t}function ve(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ye(Object(t),!0).forEach(function(n){Ne(a,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):ye(Object(t)).forEach(function(n){Object.defineProperty(a,n,Object.getOwnPropertyDescriptor(t,n))})}return a}function V(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?V=function(e){return typeof e}:V=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(a)}function Ne(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function Xe(a,e){return Ze(a)||Qe(a,e)||Ve(a,e)||Je()}function Ze(a){if(Array.isArray(a))return a}function Qe(a,e){var t=a&&(typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"]);if(t!=null){var n=[],o=!0,i=!1,u,d;try{for(t=t.call(a);!(o=(u=t.next()).done)&&(n.push(u.value),!(e&&n.length===e));o=!0);}catch(l){i=!0,d=l}finally{try{!o&&t.return!=null&&t.return()}finally{if(i)throw d}}return n}}function Ve(a,e){if(a){if(typeof a=="string")return ge(a,e);var t=Object.prototype.toString.call(a).slice(8,-1);if(t==="Object"&&a.constructor&&(t=a.constructor.name),t==="Map"||t==="Set")return Array.from(a);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ge(a,e)}}function ge(a,e){(e==null||e>a.length)&&(e=a.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=a[t];return n}function Je(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var et=function(e){var t=f.useRef(e);return f.useEffect(function(){t.current=e},[e]),t.current},J=function(e){return e!==null&&V(e)==="object"},Ce="[object Object]",tt=function a(e,t){if(!J(e)||!J(t))return e===t;var n=Array.isArray(e),o=Array.isArray(t);if(n!==o)return!1;var i=Object.prototype.toString.call(e)===Ce,u=Object.prototype.toString.call(t)===Ce;if(i!==u)return!1;if(!i&&!n)return e===t;var d=Object.keys(e),l=Object.keys(t);if(d.length!==l.length)return!1;for(var C={},N=0;N<d.length;N+=1)C[d[N]]=!0;for(var j=0;j<l.length;j+=1)C[l[j]]=!0;var S=Object.keys(C);if(S.length!==d.length)return!1;var _=e,B=t,E=function(q){return a(_[q],B[q])};return S.every(E)},rt=function(e,t,n){return J(e)?Object.keys(e).reduce(function(o,i){var u=!J(t)||!tt(e[i],t[i]);return n.includes(i)?(u&&console.warn("Unsupported prop change: options.".concat(i," is not a mutable property.")),o):u?ve(ve({},o||{}),{},Ne({},i,e[i])):o},null):null},Ee=f.createContext(null);Ee.displayName="CustomCheckoutSdkContext";var at=function(e,t){if(!e)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CustomCheckoutProvider> provider."));return e},nt=f.createContext(null);nt.displayName="CustomCheckoutContext";c.any,c.shape({clientSecret:c.string.isRequired,elementsOptions:c.object}).isRequired;var be=function(e){var t=f.useContext(Ee),n=f.useContext(Re);if(t&&n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CustomCheckoutProvider> and <Elements> providers."));return t?at(t,e):st(n,e)},Re=f.createContext(null);Re.displayName="ElementsContext";var st=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},Ae=f.createContext(null);Ae.displayName="CartElementContext";var ot=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e};c.any,c.object;var it={cart:null,cartState:null,setCart:function(){},setCartState:function(){}},Se=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=f.useContext(Ae);return t?it:ot(n,e)};c.func.isRequired;var g=function(e,t,n){var o=!!n,i=f.useRef(n);f.useEffect(function(){i.current=n},[n]),f.useEffect(function(){if(!o||!e)return function(){};var u=function(){i.current&&i.current.apply(i,arguments)};return e.on(t,u),function(){e.off(t,u)}},[o,t,e,i])},lt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},h=function(e,t){var n="".concat(lt(e),"Element"),o=function(l){var C=l.id,N=l.className,j=l.options,S=j===void 0?{}:j,_=l.onBlur,B=l.onFocus,E=l.onReady,P=l.onChange,q=l.onEscape,ee=l.onClick,te=l.onLoadError,re=l.onLoaderStart,ae=l.onNetworksChange,D=l.onCheckout,ne=l.onLineItemClick,se=l.onConfirm,oe=l.onCancel,ie=l.onShippingAddressChange,le=l.onShippingRateChange,O=be("mounts <".concat(n,">")),L="elements"in O?O.elements:null,$="customCheckoutSdk"in O?O.customCheckoutSdk:null,ce=f.useState(null),T=Xe(ce,2),y=T[0],ue=T[1],k=f.useRef(null),M=f.useRef(null),Y=Se("mounts <".concat(n,">"),"customCheckoutSdk"in O),F=Y.setCart,A=Y.setCartState;g(y,"blur",_),g(y,"focus",B),g(y,"escape",q),g(y,"click",ee),g(y,"loaderror",te),g(y,"loaderstart",re),g(y,"networkschange",ae),g(y,"lineitemclick",ne),g(y,"confirm",se),g(y,"cancel",oe),g(y,"shippingaddresschange",ie),g(y,"shippingratechange",le);var U;e==="cart"?U=function(X){A(X),E&&E(X)}:E&&(e==="expressCheckout"?U=E:U=function(){E(y)}),g(y,"ready",U);var z=e==="cart"?function(m){A(m),P&&P(m)}:P;g(y,"change",z);var G=e==="cart"?function(m){A(m),D&&D(m)}:D;g(y,"checkout",G),f.useLayoutEffect(function(){if(k.current===null&&M.current!==null&&(L||$)){var m=null;$?m=$.createElement(e,S):L&&(m=L.create(e,S)),e==="cart"&&F&&F(m),k.current=m,ue(m),m&&m.mount(M.current)}},[L,$,S,F]);var H=et(S);return f.useEffect(function(){if(k.current){var m=rt(S,H,["paymentRequest"]);m&&k.current.update(m)}},[S,H]),f.useLayoutEffect(function(){return function(){if(k.current&&typeof k.current.destroy=="function")try{k.current.destroy(),k.current=null}catch{}}},[]),f.createElement("div",{id:C,className:N,ref:M})},i=function(l){var C=be("mounts <".concat(n,">"));Se("mounts <".concat(n,">"),"customCheckoutSdk"in C);var N=l.id,j=l.className;return f.createElement("div",{id:N,className:j})},u=t?i:o;return u.propTypes={id:c.string,className:c.string,onChange:c.func,onBlur:c.func,onFocus:c.func,onReady:c.func,onEscape:c.func,onClick:c.func,onLoadError:c.func,onLoaderStart:c.func,onNetworksChange:c.func,onCheckout:c.func,onLineItemClick:c.func,onConfirm:c.func,onCancel:c.func,onShippingAddressChange:c.func,onShippingRateChange:c.func,options:c.object},u.displayName=n,u.__elementType=e,u},x=typeof window>"u",ct=f.createContext(null);ct.displayName="EmbeddedCheckoutProviderContext";h("auBankAccount",x);h("card",x);h("cardNumber",x);h("cardExpiry",x);h("cardCvc",x);h("fpxBank",x);h("iban",x);h("idealBank",x);h("p24Bank",x);h("epsBank",x);h("payment",x);h("expressCheckout",x);h("paymentRequestButton",x);h("linkAuthentication",x);h("address",x);h("shippingAddress",x);h("cart",x);h("paymentMethodMessaging",x);h("affirmMessage",x);h("afterpayClearpayMessage",x);const je=({id:a,title:e,labelImage:t,checked:n,name:o,customStyle:i,change:u})=>r.jsx("div",{className:"flex justify-between w-full gap-3 p-4",children:r.jsx(I.Radio,{id:a,onChange:d=>u(d),icon:r.jsx(we,{className:"w-[18px] h-[18px]"}),className:"border border-[#D9D9D9] bg-white p-0 w-[18px] h-[18px]",ripple:!1,name:o,label:r.jsx("div",{children:r.jsxs(I.Typography,{className:"font-medium tracking-032 flex items-center gap-1 text-sm text-b16",children:[t?r.jsx("img",{src:"/payment/"+t,className:"h-[23px] object-contain",alt:e}):null,r.jsx("span",{className:i,children:e})]})}),checked:n})}),pe=({id:a,title:e,labelImage:t,checked:n,name:o,customStyle:i,change:u})=>r.jsx("div",{className:"flex justify-between w-full gap-3 p-4",children:r.jsx(I.Radio,{id:a,onChange:d=>u(d),icon:r.jsx(we,{className:"w-[18px] h-[18px]"}),className:"border border-[#D9D9D9] bg-white p-0 w-[18px] h-[18px]",ripple:!1,name:o,label:r.jsx("div",{children:r.jsxs(I.Typography,{className:"font-medium tracking-032 flex items-center gap-1 text-sm text-b16",children:[(t==null?void 0:t.length)>0?t.map(d=>r.jsx("img",{src:"/payment/"+d,className:"h-[23px] object-contain",alt:e})):null,r.jsx("span",{className:i,children:e})]})}),checked:n===o})}),ut=({payment:a,setPayment:e,setBilling:t,billing:n})=>{const[o,i]=p.useState(!0),u=l=>{const C=l.target;C.name==="shipping_address"&&(i(C.checked),t(!1)),C.name==="billing_address"&&(t(C.checked),i(!1))},d=l=>{e(l.target.name)};return r.jsxs("div",{children:[r.jsxs("div",{className:"space-y-14px mt-8",children:[r.jsx("h3",{className:"text-lg font-medium text-b16",children:"Payment"}),r.jsxs("p",{className:"flex gap-1 items-center text-sm text-b32 font-medium",children:[r.jsx(ze,{className:"text-b3 text-xs"})," All transactions are secure and encrypted."]}),r.jsxs("div",{className:"[&>*]:border-b [&>*]:border-b31 [&>*:last-child]:border-0 border border-b31 rounded-md",children:[r.jsx(pe,{customStyle:"font-medium",change:d,name:"card",id:"credit_card",checked:a,labelImage:["visa.png","master.png","express.png"]}),r.jsx(pe,{name:"paypal",change:d,checked:a,labelImage:["pay_paypal.webp"],id:"paypal"}),r.jsx(pe,{name:"affirm",change:d,checked:a,id:"affirm",labelImage:["affirm.webp"]})]})]}),r.jsxs("div",{className:"mt-8",children:[r.jsx("h3",{className:"text-lg font-medium text-b16",children:"Billing address"}),r.jsx("p",{className:"flex gap-1 items-center text-sm text-b32",children:"Select the address that matches your card of payment method."}),r.jsxs("div",{className:"mt-14px [&>*]:border-b [&>*]:border-b31 [&>*:last-child]:border-0 border border-b31 rounded-md",children:[r.jsx(je,{checked:o,change:u,name:"shipping_address",id:"shipping_address",title:"Same as shipping address"}),r.jsx(je,{checked:n,change:u,name:"billing_address",id:"billing_address",title:"Use a different billing address"})]})]})]})},dt=()=>r.jsx(r.Fragment,{children:r.jsxs("div",{className:"fixed flex flex-col space-y-5 items-center justify-center top-0 w-full h-screen z-40 bg-white/80",children:[r.jsx(Ge,{className:"text-b6 text-6xl animate-spin"}),r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("h4",{className:"font-semibold text-sm",children:"Your order’s being processed."}),r.jsx("p",{className:"font-medium text-sm",children:"Please wait while we process your order."})]})]})}),pt="",Pe=De.create({baseURL:pt,headers:{"Content-Type":"application/json"}}),mt=async()=>{let a;try{a=await Pe.get("/api/stripe/get-publish-key")}catch(e){return e}return a},ft=async a=>{let e;try{e=await Pe.post("/api/stripe/create-checkout-session",a,{validateStatus:()=>!0})}catch(t){return t}return e};var qe="https://js.stripe.com/v3",ht=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ke="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",xt=function(){for(var e=document.querySelectorAll('script[src^="'.concat(qe,'"]')),t=0;t<e.length;t++){var n=e[t];if(ht.test(n.src))return n}return null},yt=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(qe).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(n),n},vt=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.1.10",startTime:t})},Q=null,gt=function(e){return Q!==null||(Q=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(ke),window.Stripe){t(window.Stripe);return}try{var o=xt();o&&e?console.warn(ke):o||(o=yt(e)),o.addEventListener("load",function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))}),o.addEventListener("error",function(){n(new Error("Failed to load Stripe.js"))})}catch(i){n(i);return}})),Q},Ct=function(e,t,n){if(e===null)return null;var o=e.apply(void 0,t);return vt(o,n),o},Oe=Promise.resolve().then(function(){return gt(null)}),Le=!1;Oe.catch(function(a){Le||console.warn(a)});var bt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Le=!0;var o=Date.now();return Oe.then(function(i){return Ct(i,t,o)})};const Ut=()=>{const[a,e]=p.useState(!1),t=$e();Me();const n=w(s=>s.cart.deliveryOrders),o=w(s=>s.cart.pickupOrders);n.length===0&&o.length===0&&t("/mycart");const{email:i,address:u,postalCode:d,city:l,country:C,province:N}=w(s=>s.order.orderInfo),j=w(s=>s.cart.deliveryInfo),S=[{name:"USA",value:"usa"}],_=[{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"}],[B,E]=p.useState(""),[P,q]=p.useState(!1),[ee,te]=p.useState(""),[re,ae]=p.useState(""),[D,ne]=p.useState(""),[se,oe]=p.useState(""),[ie,le]=p.useState(""),[O,L]=p.useState("usa"),[$,ce]=p.useState("alberta"),[T,y]=p.useState(""),[ue,k]=p.useState(""),[M,Y]=p.useState(!1);xe().shape({email:b().required("Email is Required!"),firstName:b().nullable(),lastName:b().required("Last Name is Required!"),address:b().required("Address is Required!"),appartment:b().nullable(),city:b().required("City is Required!"),country:b().required("Country is Required!"),province:b().required("Province is Required!"),postalCode:b().required("Postal Code is Required!"),phone:b().required("Phone is Required!")});const[F,A]=p.useState(!1),U=async()=>{A(!0);const s=await CheckZip({zip:T});console.log(s),s.status==200,A(!1)};p.useEffect(()=>{T.length===5&&U()},[T]);const z=s=>{const{name:W,checked:K}=s.target;W==="keepUpdates"&&q(K),W==="saveAddress"&&Y(K)},[G,H]=p.useState(!1),[m,X]=p.useState("card");p.useState([]),xe().shape({cardNo:b().matches(/^\d{16}$/,"Must be exactly 16 digits").required("Card Number is Required!"),name:b().required("Card Holder Name is Required!"),expDate:b().required("Card Expiry Date is Required!"),code:b().required("Security Code is Required!")});const[v,St]=p.useState(!1);p.useState([]);const[Te,jt]=p.useState((n==null?void 0:n.length)>0?"delivery":"pickup");p.useState(!1);const Ue=w(s=>s.order.orderInfo);w(s=>s.order.paymentInfo);const Ie=w(s=>s.cart.cartId);w(s=>s.user._id),w(s=>s.user.auth),w(s=>s.user.isAdmin);const _e=async s=>{const W=await mt();if(W.status===200){const K=await bt(W.data.stripePublishKey);if(K){const Be={cartId:Ie,orderType:Te,paymentMod:m,customerEmail:Ue.email},me=await ft(Be);if(me.status===200){const de=K.redirectToCheckout({sessionId:me.data.id});de.error&&(console.log(de.error),fe(de.error,"error",2e3))}}}else fe("Stripe Payment Not Available!","error",2e3)};return r.jsxs(r.Fragment,{children:["  ",a?r.jsx(dt,{}):r.jsxs(We,{children:[r.jsx("img",{src:"/login_logo.webp",alt:""}),r.jsx(Ke,{}),r.jsxs("div",{className:"border border-b31 p-3 flex flex-col gap-3 rounded-md",children:[r.jsx(Z,{title:"Contact",detail:i,textStyle:"font-medium"}),r.jsx("hr",{}),r.jsx(Z,{title:"Ship to",detail:`${u},${l} ,${N}, ${C},${d}`,textStyle:"font-medium"}),r.jsx("hr",{}),(n==null?void 0:n.length)>0?r.jsx(Z,{title:"Method",detail:`Home Delivery · $${j.shipping}`,subtitle:"1 to 3 Business Days",textStyle:"font-medium"}):null,(o==null?void 0:o.length)>0?r.jsx(Z,{title:"Method",detail:"Self Pickup · Free",subtitle:"Always Ready!",textStyle:"font-medium"}):null]}),r.jsx(ut,{payment:m,setPayment:X,billing:G,setBilling:H}),r.jsxs("div",{className:`${G?"flex flex-col":"hidden"} duration-300  border-[1px] border-b31 rounded-md mt-3 px-4 py-4`,children:[r.jsxs("div",{className:"space-y-14px [&>*]:text-b16 [&>*]:text-sm",children:[r.jsx("h3",{className:"!text-lg font-medium text-b16",children:"Billing information"}),r.jsx(R,{width:"full",name:"Email",title:"Email",iscompulsory:"false",type:"text",value:B,onChange:s=>E(s.target.value),error:!!(v&&v.includes("Email is Required!")),errormessage:"Email is Required!",placeholder:"abc@gmail.com"}),r.jsx(I.Checkbox,{onChange:s=>z(s),checked:P,defaultChecked:!1,name:"keepUpdates",id:"keep-me-update",label:"Keep me up to date on news and exclusive offers",className:"checked:bg-black border-b31",ripple:!1})]}),r.jsxs("div",{className:"space-y-14px mt-8",children:[r.jsx("h3",{className:"text-sm font-medium text-b16",children:"Shipping address"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(R,{width:"full",name:"firstName",title:"",iscompulsory:"false",type:"text",value:ee,onChange:s=>te(s.target.value),error:!!(v&&v.includes("First Name is Required!")),errormessage:"First Name is Required!",placeholder:"First Name (optional)"}),r.jsx(R,{width:"full",name:"lastName",title:"",iscompulsory:"false",type:"text",value:re,onChange:s=>ae(s.target.value),error:!!(v&&v.includes("Last Name is Required!")),errormessage:"Last Name is Required!",placeholder:"Last Name"}),r.jsxs("div",{className:"col-span-2 space-y-3",children:[r.jsx(R,{width:"full",name:"address",title:"",iscompulsory:"false",type:"text",value:D,onChange:s=>ne(s.target.value),error:!!(v&&v.includes("Address is Required!")),errormessage:"Address is Required!",placeholder:"Address"}),r.jsx(R,{width:"full",name:"appartment",title:"",iscompulsory:"false",type:"text",value:se,onChange:s=>oe(s.target.value),error:!!(v&&v.includes("Apartment, suite is Required!")),errormessage:"Apartment, suite is Required!",placeholder:"Apartment, suite, etc. (optional)"}),r.jsx(R,{width:"full",name:"city",title:"",iscompulsory:"false",type:"text",value:ie,onChange:s=>le(s.target.value),error:!!(v&&v.includes("City is Required!")),errormessage:"City is Required!",placeholder:"City"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-14px",children:[r.jsx(he,{setState:L,id:"country_region",label:"Country / region",Options:S}),r.jsx(he,{setState:ce,id:"province",label:"Province",Options:_}),r.jsxs("div",{className:"relative  col-span-2 md:col-span-1 [&>*]:h-full",children:[F?r.jsx("div",{className:"absolute flex rounded-lg items-center w-full justify-end px-2",children:r.jsx("img",{src:"/loader-bg.gif",className:"w-4 h-4"})}):null,r.jsx(R,{width:"full",name:"postalCode",title:"",iscompulsory:"false",type:"text",value:d,onChange:s=>y(s.target.value),error:!!(v&&v.includes("Postal Code is Required!")),errormessage:"Postal Code is Required!",placeholder:"Postal Code"})]})]}),r.jsxs("div",{className:"relative",children:[r.jsx(R,{width:"full",name:"phone",title:"",iscompulsory:"false",type:"text",value:ue,onChange:s=>k(s.target.value),error:!!(v&&v.includes("Phone is Required!")),errormessage:"Phone is Required!",placeholder:"Phone"}),r.jsx("div",{className:"absolute right-3 top-3",children:r.jsx(He,{className:"text-2xl text-b3"})})]}),r.jsx("div",{className:"[&>*]:text-b16 [&>*]:text-sm",children:r.jsx(I.Checkbox,{onChange:s=>z(s),id:"save-information",name:"saveAddress",checked:M,defaultChecked:!1,label:"Save this information for next time",className:"checked:bg-black border-b31",ripple:!1})})]})]})]})]}),r.jsxs("div",{className:"flex justify-between items-center w-full mt-5",children:[r.jsxs(Fe,{to:"/mycart/shipping",className:"flex gap-1 items-center",children:[r.jsx(Ye,{}),r.jsx("span",{className:"text-sm font-medium text-b3",children:"Return to shipping"})]}),r.jsx("button",{type:"button",onClick:_e,className:"cursor-pointer py-3 px-6 text-xs rounded-lg bg-b3 text-white",children:"Pay Now"})]})]})]})};export{Ut as default};
