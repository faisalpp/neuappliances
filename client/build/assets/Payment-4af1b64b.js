import{r,j as e,u as De,e as Te,f as p,T as m,a1 as Oe,a0 as Ue,a9 as Y,aa as ee,ab as se,L as Me,a3 as Ze,ac as ze,ad as j,ae as N,af as He,ag as Ke,ah as Qe,s as te,t as ae}from"./index-8fa978d7.js";import{C as Ve,B as Ge,L as Je}from"./LeftArrowSvg-2d0b2704.js";import{R as F}from"./ReviewDetail-be867f1f.js";import{am as We,r as w,A as Xe,R as Ye}from"./ScrollToTop-377155f7.js";import{n as ie,k as es}from"./MainLayout-e7ebb6b6.js";import{T as y}from"./TextInput-0681361f.js";import{C as re}from"./CustomSelect-14a7d8d4.js";import{c as ss,a as x}from"./index.esm-1e9dfcd6.js";import{i as ts}from"./isAdmin-8d9fe460.js";import"./CustomInput-954168e9.js";import"./index.esm-4cafad3c.js";import"./index-b7b6efe6.js";const le=({id:b,title:n,labelImage:c,checked:t,name:l,customStyle:u,change:g})=>e.jsx("div",{className:"flex justify-between w-full gap-3 p-4",children:e.jsx(w.Radio,{id:b,onChange:h=>g(h),icon:e.jsx(ie,{className:"w-[18px] h-[18px]"}),className:"border border-[#D9D9D9] bg-white p-0 w-[18px] h-[18px]",ripple:!1,name:l,label:e.jsx("div",{children:e.jsxs(w.Typography,{className:"font-medium tracking-032 flex items-center gap-1 text-sm text-b16",children:[c?e.jsx("img",{src:"/payment/"+c,className:"h-[23px] object-contain",alt:n}):null,e.jsx("span",{className:u,children:n})]})}),checked:t})}),D=({id:b,title:n,labelImage:c,checked:t,name:l,customStyle:u,change:g})=>e.jsx("div",{className:"flex justify-between w-full gap-3 p-4",children:e.jsx(w.Radio,{id:b,onChange:h=>g(h),icon:e.jsx(ie,{className:"w-[18px] h-[18px]"}),className:"border border-[#D9D9D9] bg-white p-0 w-[18px] h-[18px]",ripple:!1,name:l,label:e.jsx("div",{children:e.jsxs(w.Typography,{className:"font-medium tracking-032 flex items-center gap-1 text-sm text-b16",children:[(c==null?void 0:c.length)>0?c.map(h=>e.jsx("img",{src:"/payment/"+h,className:"h-[23px] object-contain",alt:n})):null,e.jsx("span",{className:u,children:n})]})}),checked:t===l})}),as=({CardNumber:b,CardExpiry:n,CardCvc:c,handleCardPayment:t,payment:l,setPayment:u,setBilling:g,billing:h})=>{const[S,P]=r.useState(!0),R=A=>{const v=A.target;v.name==="shipping_address"&&(P(v.checked),g(!1)),v.name==="billing_address"&&(g(v.checked),P(!1))},k=A=>{u(A.target.name)};return e.jsxs("div",{children:[e.jsxs("div",{className:"space-y-14px mt-8",children:[e.jsx("h3",{className:"text-lg font-medium text-b16",children:"Payment"}),e.jsxs("p",{className:"flex gap-1 items-center text-sm text-b32 font-medium",children:[e.jsx(We,{className:"text-b3 text-xs"})," All transactions are secure and encrypted."]}),e.jsxs("div",{className:"[&>*]:border-b [&>*]:border-b31 [&>*:last-child]:border-0 border border-b31 rounded-md",children:[e.jsx(D,{customStyle:"font-medium",change:k,name:"card",id:"credit_card",checked:l,labelImage:["visa.png","master.png","express.png"]}),e.jsxs("form",{onSubmit:t,className:"p-4 bg-[#F9F9F9] grid grid-cols-1 gap-14px",children:[e.jsx("div",{className:"relative flex justify-center items-center h-10 bg-[#F9F9F9]",children:e.jsxs("div",{className:"bg-white text-sm outline-none border-[1px] border-b31 w-full px-4 h-10 rounded-lg",children:[e.jsx(b,{className:"py-3"}),e.jsx("div",{className:"absolute right-4 top-0 h-full flex items-center",children:e.jsx("img",{className:"w-[18px] h-[18px]",src:"/svgs/lock.webp"})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-14px",children:[e.jsx("div",{className:"relative flex justify-center items-center h-10 bg-[#F9F9F9]",children:e.jsx("div",{className:"bg-white text-sm outline-none border-[1px] border-b31 w-full px-4 h-10 rounded-lg",children:e.jsx(n,{className:"py-3"})})}),e.jsx("div",{className:"relative flex justify-center items-center h-10 bg-[#F9F9F9]",children:e.jsx("div",{className:"bg-white text-sm outline-none border-[1px] border-b31 w-full px-4 h-10 rounded-lg",children:e.jsx(c,{className:"py-3"})})})]})]}),e.jsx(D,{name:"paypal",change:k,checked:l,labelImage:["pay_paypal.webp"],id:"paypal"}),e.jsx(D,{name:"affirm",change:k,checked:l,id:"affirm",labelImage:["affirm.webp"]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-medium text-b16",children:"Billing address"}),e.jsx("p",{className:"flex gap-1 items-center text-sm text-b32",children:"Select the address that matches your card of payment method."}),e.jsxs("div",{className:"mt-14px [&>*]:border-b [&>*]:border-b31 [&>*:last-child]:border-0 border border-b31 rounded-md",children:[e.jsx(le,{checked:S,change:R,name:"shipping_address",id:"shipping_address",title:"Same as shipping address"}),e.jsx(le,{checked:h,change:R,name:"billing_address",id:"billing_address",title:"Use a different billing address"})]})]})]})},rs=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"fixed flex flex-col space-y-5 items-center justify-center top-0 w-full h-screen z-40 bg-white/80",children:[e.jsx(Xe,{className:"text-b6 text-6xl animate-spin"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Your order’s being processed."}),e.jsx("p",{className:"font-medium text-sm",children:"Please wait while we process your order."})]})]})}),bs=()=>{const[b,n]=r.useState(!1),c=De(),t=Te(),l=p(s=>s.cart.deliveryOrders),u=p(s=>s.cart.pickupOrders);r.useEffect(()=>{(l==null?void 0:l.length)===0&&(u==null?void 0:u.length)===0&&(m("Cart is Empty","error",1e3),c("/mycart"))},[]);const{email:g,address:h,postalCode:S,city:P,country:R,province:k}=p(s=>s.order.orderInfo)||{},A=p(s=>s.cart.deliveryInfo),v=[{name:"USA",value:"us"}],ne=[{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"}],[I,de]=r.useState(""),[T,oe]=r.useState(!1),[O,ce]=r.useState(""),[U,me]=r.useState(""),[M,ue]=r.useState(""),[Z,pe]=r.useState(""),[z,xe]=r.useState(""),[he,fe]=r.useState("usa"),[ge,ye]=r.useState("alberta"),[_,be]=r.useState(""),[H,je]=r.useState(""),[Ne,ve]=r.useState(!1),Ce=ss().shape({email:x().required("Email is Required!"),firstName:x().nullable(),lastName:x().required("Last Name is Required!"),address:x().required("Address is Required!"),appartment:x().nullable(),city:x().required("City is Required!"),country:x().required("Country is Required!"),province:x().required("Province is Required!"),postalCode:x().required("Postal Code is Required!"),phone:x().required("Phone is Required!")}),[we,L]=r.useState(!1),Se=async()=>{L(!0);const s=await CheckZip({zip:_});console.log(s),s.status==200,L(!1)};r.useEffect(()=>{_.length===5&&Se()},[_]);const K=s=>{const{name:a,checked:o}=s.target;a==="keepUpdates"&&oe(o),a==="saveAddress"&&ve(o)},[$,ke]=r.useState(!1),[Q,Ae]=r.useState("card"),[d,V]=r.useState(!1),[q,ls]=r.useState([]),[Pe,is]=r.useState((l==null?void 0:l.length)>0?"delivery":"pickup"),Re=async()=>{try{const s={email:I,firstName:O,lastName:U,address:M,appartment:Z,city:z,country:he,state:ge,postalCode:S,phone:H};return await Ce.validate(s,{abortEarly:!1}),T&&q.push(I),{status:!0,data:s}}catch(s){if(s){let a=s.errors;return V(a),a.forEach(o=>{m(o,"error",1e3)}),{status:!1}}else V([])}},i=p(s=>s.order.orderInfo),qe=p(s=>s.cart.cartId),Ee=p(s=>s.user._id),Fe=p(s=>s.user.auth),f=p(s=>s.order.orderErrors),B=p(s=>s.order.orderStatus),Ie=ts(),E=Oe(),G=Ue(),_e=async s=>{m("Paypal Transaction!","success",1e3)},Le=async s=>{m("Affirm Transaction!","success",1e3)},J=async s=>{const a=E.getElement(Y);E.getElement(ee),E.getElement(se);const o=await Ze({price:200*100,mode:["card"],currency:"usd",description:"Neuappliance Outlet Card Transaction"});if(o)return await G.confirmCardPayment(o.data.payIntent.client_secret,{payment_method:{card:a,billing_details:{name:`${i.firstName} ${i.lastName}`,email:i.email,address:{line1:i.address,city:i.city,country:"us",postal_code:i.postalCode,state:i.state}}}});m("Payment Intent Error!","error",1e3)},W=async(s,a)=>{if(f.confirm||!B.confirm){const o=await Qe({orderNo:a,intent:s,status:"Completed"});console.log(o),o.status===200?(j({confirm:!1}),N({confirm:!0}),m(o.data.msg,"success",1e3),t(te()),t(ae()),n(!1),c("/")):(j({confirm:!0}),N({confirm:!1}),m(o.data.message,"error",1e3),n(!1))}else m("Order Already Complete!","success",1e3),t(te()),t(ae()),n(!1),c("/")},$e=p(s=>s.order.paymentIntent),X=async s=>{if(f.payment||!B.payment){if(!G&&!E){m("Stripe Not Loaded!","error",100),t(j({payment:!0})),t(N({payment:!1})),n(!1);return}let a;switch(Q){case"card":a=await J();break;case"paypal":await _e();break;case"affirm":await Le();break}a!=null&&a.error?(t(j({payment:!0})),t(N({payment:!1})),n(!1),m(a.error.type,"error",1e3)):(t(j({payment:!1})),t(N({payment:!0})),t(Ke(a.paymentIntent)),W(a.paymentIntent,s))}else W($e)},Be=async s=>{if(s.preventDefault(),n(!0),f.order||!B.order){let a={status:!1};if($?(i!=null&&i.keepUpdates&&q.push(i.email),a=await Re()):(i!=null&&i.keepUpdates&&q.push(i.email),a={status:!0,data:{...i}}),a.status){const o={userId:Ee,isAdmin:Ie,isAuth:Fe,cartId:qe,orderType:Pe,shippingAddress:i,billingInfo:a.data,newsEmail:q},C=await ze(o);console.log(C.data),C.status===200?(t(j({order:!1})),t(N({order:!0})),t(He(C.data.orderNo)),X(C.data.orderNo)):(t(j({order:!0})),t(N({order:!1})),m(C.data.message,"error",1e3),n(!1))}else m("Billing Address Not Found!","error",1e3),n(!1)}else m("Order Already Placed...","success",1e3),X()};return e.jsxs(e.Fragment,{children:["  ",b?e.jsx(rs,{}):null,e.jsxs(Ve,{children:[e.jsx("img",{src:"/login_logo.webp",alt:""}),e.jsx(Ge,{}),e.jsxs("div",{className:"border border-b31 p-3 flex flex-col gap-3 rounded-md",children:[e.jsx(F,{title:"Contact",detail:g,textStyle:"font-medium"}),e.jsx("hr",{}),e.jsx(F,{title:"Ship to",detail:`${h},${P} ,${k}, ${R},${S}`,textStyle:"font-medium"}),e.jsx("hr",{}),(l==null?void 0:l.length)>0?e.jsx(F,{title:"Method",detail:`Home Delivery · $${A.shipping}`,subtitle:"1 to 3 Business Days",textStyle:"font-medium"}):null,(u==null?void 0:u.length)>0?e.jsx(F,{title:"Method",detail:"Self Pickup · Free",subtitle:"Always Ready!",textStyle:"font-medium"}):null]}),e.jsx(as,{CardNumber:Y,CardExpiry:ee,CardCvc:se,handleCardPayment:J,payment:Q,setPayment:Ae,billing:$,setBilling:ke}),e.jsxs("div",{className:`${$?"flex flex-col":"hidden"} duration-300  border-[1px] border-b31 rounded-md mt-3 px-4 py-4`,children:[e.jsxs("div",{className:"space-y-14px [&>*]:text-b16 [&>*]:text-sm",children:[e.jsx("h3",{className:"!text-lg font-medium text-b16",children:"Billing information"}),e.jsx(y,{width:"full",name:"Email",title:"Email",iscompulsory:"false",type:"text",value:I,onChange:s=>de(s.target.value),error:!!(d&&d.includes("Email is Required!")),errormessage:"Email is Required!",placeholder:"abc@gmail.com"}),e.jsx(w.Checkbox,{onChange:s=>K(s),checked:T,defaultChecked:!1,name:"keepUpdates",id:"keep-me-update",label:"Keep me up to date on news and exclusive offers",className:"checked:bg-black border-b31",ripple:!1})]}),e.jsxs("div",{className:"space-y-14px mt-8",children:[e.jsx("h3",{className:"text-sm font-medium text-b16",children:"Shipping address"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(y,{width:"full",name:"firstName",title:"",iscompulsory:"false",type:"text",value:O,onChange:s=>ce(s.target.value),error:!!(d&&d.includes("First Name is Required!")),errormessage:"First Name is Required!",placeholder:"First Name (optional)"}),e.jsx(y,{width:"full",name:"lastName",title:"",iscompulsory:"false",type:"text",value:U,onChange:s=>me(s.target.value),error:!!(d&&d.includes("Last Name is Required!")),errormessage:"Last Name is Required!",placeholder:"Last Name"}),e.jsxs("div",{className:"col-span-2 space-y-3",children:[e.jsx(y,{width:"full",name:"address",title:"",iscompulsory:"false",type:"text",value:M,onChange:s=>ue(s.target.value),error:!!(d&&d.includes("Address is Required!")),errormessage:"Address is Required!",placeholder:"Address"}),e.jsx(y,{width:"full",name:"appartment",title:"",iscompulsory:"false",type:"text",value:Z,onChange:s=>pe(s.target.value),error:!!(d&&d.includes("Apartment, suite is Required!")),errormessage:"Apartment, suite is Required!",placeholder:"Apartment, suite, etc. (optional)"}),e.jsx(y,{width:"full",name:"city",title:"",iscompulsory:"false",type:"text",value:z,onChange:s=>xe(s.target.value),error:!!(d&&d.includes("City is Required!")),errormessage:"City is Required!",placeholder:"City"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-14px",children:[e.jsx(re,{setState:fe,id:"country_region",label:"Country / region",Options:v}),e.jsx(re,{setState:ye,id:"province",label:"Province",Options:ne}),e.jsxs("div",{className:"relative  col-span-2 md:col-span-1 [&>*]:h-full",children:[we?e.jsx("div",{className:"absolute flex rounded-lg items-center w-full justify-end px-2",children:e.jsx("img",{src:"/loader-bg.gif",className:"w-4 h-4"})}):null,e.jsx(y,{width:"full",name:"postalCode",title:"",iscompulsory:"false",type:"text",value:S,onChange:s=>be(s.target.value),error:!!(d&&d.includes("Postal Code is Required!")),errormessage:"Postal Code is Required!",placeholder:"Postal Code"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{width:"full",name:"phone",title:"",iscompulsory:"false",type:"text",value:H,onChange:s=>je(s.target.value),error:!!(d&&d.includes("Phone is Required!")),errormessage:"Phone is Required!",placeholder:"Phone"}),e.jsx("div",{className:"absolute right-3 top-3",children:e.jsx(es,{className:"text-2xl text-b3"})})]}),e.jsx("div",{className:"[&>*]:text-b16 [&>*]:text-sm",children:e.jsx(w.Checkbox,{onChange:s=>K(s),id:"save-information",name:"saveAddress",checked:Ne,defaultChecked:!1,label:"Save this information for next time",className:"checked:bg-black border-b31",ripple:!1})})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center w-full mt-5",children:[e.jsxs(Me,{to:"/mycart/shipping",className:"flex gap-1 items-center",children:[e.jsx(Je,{}),e.jsx("span",{className:"text-sm font-medium text-b3",children:"Return to shipping"})]}),e.jsx("button",{type:"button",onClick:Be,className:`flex space-x-1 cursor-pointer py-3 px-6 text-xs rounded-lg ${f.order||f.payment||f.confirm?"bg-red-500":"bg-b3"} text-white`,children:f.order||f.payment||f.confirm?e.jsxs("div",{className:"flex space-x-1 items-center",children:[e.jsx("span",{children:"Try Again"})," ",e.jsx(Ye,{className:"text-white text-sm"})]}):e.jsx("span",{children:"Pay Now"})})]})]})]})};export{bs as default};
