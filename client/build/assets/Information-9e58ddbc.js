import{p as oe,q as i,a5 as d,u as ne,r as a,w as p,a6 as ce,j as s,L as K,av as o,aW as Q,bQ as de,bR as ue,aU as me,bS as pe,bT as fe,ar as he,bU as xe,ap as ge,aq as ve}from"./index-820351db.js";import{C as ye,B as be,L as je}from"./LeftArrowSvg-8d482f9e.js";import{C as $}from"./CustomSelect-a669b826.js";import"./CustomInput-34acc87d.js";const Ae=()=>{const G=[{name:"USA",value:"usa"}],M=[{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"}],V=oe().shape({email:i().required("Email is Required!"),firstName:i().nullable(),lastName:i().required("Last Name is Required!"),address:i().required("Address is Required!"),appartment:i().nullable(),city:i().required("City is Required!"),country:i().required("Country is Required!"),province:i().required("Province is Required!"),postalCode:i().required("Postal Code is Required!"),phone:i().required("Phone is Required!")}),h=d(e=>{var t;return(t=e.cart)==null?void 0:t.cart.products});d(e=>e.order.orderInfo);const x=ne();a.useEffect(()=>{(h==null?void 0:h.length)===0&&(p("Cart is Empty","error",1e3),x("/mycart"))},[]);const n=d(e=>{var t;return(t=e.cart)==null?void 0:t.cart.orderInfo}),[g,v]=a.useState(""),[y,b]=a.useState(!1),[j,C]=a.useState(""),[N,S]=a.useState(""),[q,A]=a.useState(""),[R,w]=a.useState(""),[k,E]=a.useState(""),[W,P]=a.useState("usa"),[I,L]=a.useState("alberta"),[l,U]=a.useState((n==null?void 0:n.type)==="delivery"?n.location:""),[z,F]=a.useState(""),[Z,O]=a.useState(!1),H=d(e=>e.user.auth),J=e=>{v(e.email),b(e.keepUpdates),C(e.firstName),S(e.lastName),A(e.address),w(e.appartment),E(e.city),P(e.country),L(e.province),U(e.postalCode),F(e.phone),O(e.saveAddress)},X=d(e=>e.user._id),Y=async()=>{if(H){const e=await pe({userId:X});e.status===200&&e.data.shippingAddress&&J(e.data.shippingAddress)}};a.useEffect(()=>{Y()},[]);const[r,_]=a.useState([]),f=ce(),D=e=>{const{name:t,checked:m}=e.target;t==="keepUpdates"&&b(m),t==="saveAddress"&&O(m)},ee=async e=>{e.preventDefault();const t={email:g,firstName:j,lastName:N,address:q,appartment:R,city:k,country:W,state:I,postalCode:l,phone:z,saveAddress:Z,keepUpdates:y,province:I};try{await V.validate(t,{abortEarly:!1}),f(fe(t)),x("/mycart/shipping")}catch(m){if(m){let B=m.errors;_(B),B.forEach(le=>{p(le,"error",1e3)})}else _([])}},[se,c]=a.useState(!1),[te,T]=a.useState(!1),[ae,u]=a.useState(!1),re=d(e=>{var t;return(t=e.cart)==null?void 0:t.cart._id}),ie=async()=>{T(!1),u(!1),c(!0);const e=await he({zip:l});if(console.log(e),e.data.status===500)u(!0),c(!1),p("Shipping Not Available!","info",1e3);else if(e.status===200){const t=await f(xe({cartId:re,orderInfo:{...n,location:l,shipping:e.data.zip.location.rate}}));t.payload.status===200?(T(!0),c(!1)):t.payload.status===404?(u(!0),c(!1),f(ge()),f(ve()),x("/mycart"),p(t.payload.message,"info",1e3)):(u(!0),c(!1),p(t.payload.message,"error",1e3))}else u(!0),c(!1)};return a.useEffect(()=>{(l==null?void 0:l.length)===5&&n.type==="delivery"&&ie()},[l]),s.jsx(s.Fragment,{children:s.jsxs(ye,{children:[s.jsx(K,{to:"/",children:s.jsx("img",{src:"/login_logo.webp",alt:""})}),s.jsx(be,{}),s.jsxs("form",{onSubmit:ee,children:[s.jsxs("div",{className:"space-y-14px [&>*]:text-b16 [&>*]:text-sm",children:[s.jsx("h3",{className:"text-sm font-medium text-b16",children:"Contact information"}),s.jsx(o,{width:"full",name:"Email",title:"Email",iscompulsory:"false",type:"text",value:g,onChange:e=>v(e.target.value),error:!!(r&&r.includes("Email is Required!")),errormessage:"Email is Required!",placeholder:"abc@gmail.com"}),s.jsx(Q.Checkbox,{onChange:e=>D(e),checked:y,defaultChecked:!1,name:"keepUpdates",id:"keep-me-update",label:"Keep me up to date on news and exclusive offers",className:"checked:bg-black border-b31",ripple:!1})]}),s.jsxs("div",{className:"space-y-14px mt-8",children:[s.jsx("h3",{className:"text-lg font-medium text-b16",children:"Shipping address"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(o,{width:"full",name:"firstName",title:"",iscompulsory:"false",type:"text",value:j,onChange:e=>C(e.target.value),error:!!(r&&r.includes("First Name is Required!")),errormessage:"First Name is Required!",placeholder:"First Name (optional)"}),s.jsx(o,{width:"full",name:"lastName",title:"",iscompulsory:"false",type:"text",value:N,onChange:e=>S(e.target.value),error:!!(r&&r.includes("Last Name is Required!")),errormessage:"Last Name is Required!",placeholder:"Last Name"}),s.jsxs("div",{className:"col-span-2 space-y-3",children:[s.jsx(o,{width:"full",name:"address",title:"",iscompulsory:"false",type:"text",value:q,onChange:e=>A(e.target.value),error:!!(r&&r.includes("Address is Required!")),errormessage:"Address is Required!",placeholder:"Address"}),s.jsx(o,{width:"full",name:"appartment",title:"",iscompulsory:"false",type:"text",value:R,onChange:e=>w(e.target.value),error:!!(r&&r.includes("Apartment, suite is Required!")),errormessage:"Apartment, suite is Required!",placeholder:"Apartment, suite, etc. (optional)"}),s.jsx(o,{width:"full",name:"city",title:"",iscompulsory:"false",type:"text",value:k,onChange:e=>E(e.target.value),error:!!(r&&r.includes("City is Required!")),errormessage:"City is Required!",placeholder:"City"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-14px",children:[s.jsx($,{setState:P,id:"country_region",label:"Country / region",Options:G}),s.jsx($,{setState:L,id:"province",label:"Province",Options:M}),s.jsxs("div",{className:"relative  col-span-2 md:col-span-1 [&>*]:h-full",children:[se?s.jsx("div",{className:"absolute z-40 flex right-0 rounded-lg items-center w-fit justify-end px-2",children:s.jsx("img",{src:"/loader-bg.gif",className:"w-4 h-4"})}):null,te?s.jsx("div",{className:"absolute z-40 flex rounded-lg items-center w-fit right-0 justify-end px-2 text-xl text-green-500",children:s.jsx(de,{})}):null,ae?s.jsx("div",{className:"absolute z-40 flex rounded-lg items-center w-fit justify-end px-2 right-1 text-xl text-red-500",children:s.jsx(ue,{})}):null,s.jsx(o,{width:"full",name:"postalCode",title:"",iscompulsory:"false",type:"text",value:l,onChange:e=>U(e.target.value),error:!!(r&&r.includes("Postal Code is Required!")),errormessage:"Postal Code is Required!",placeholder:"Postal Code"})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(o,{width:"full",name:"phone",title:"",iscompulsory:"false",type:"text",value:z,onChange:e=>F(e.target.value),error:!!(r&&r.includes("Phone is Required!")),errormessage:"Phone is Required!",placeholder:"Phone"}),s.jsx("div",{className:"absolute right-3 top-3",children:s.jsx(me,{className:"text-2xl text-b3"})})]}),s.jsx("div",{className:"[&>*]:text-b16 [&>*]:text-sm",children:s.jsx(Q.Checkbox,{onChange:e=>D(e),id:"save-information",name:"saveAddress",checked:Z,defaultChecked:!1,label:"Save this information for next time",className:"checked:bg-black border-b31",ripple:!1})})]})]})]}),s.jsxs("div",{className:"flex justify-between items-center w-full mt-5",children:[s.jsxs(K,{to:"/mycart",className:"flex gap-1 items-center",children:[s.jsx(je,{}),s.jsx("span",{className:"text-sm font-medium text-b3",children:"Return to Cart"})]}),s.jsx("button",{type:"submit",className:"flex items-center py-3 px-6 text-xs rounded-lg bg-b3 text-white",children:"Continue to Shipping"})]})]})]})})};export{Ae as default};
