import{r as t,j as e,u as Le,e as $e,f as u,T as d,a1 as Be,a0 as De,a9 as W,aa as X,ab as Y,L as Te,a3 as Ue,ac as Oe,ad as j,ae as Me,af as Ze,ag as ze}from"./index-8c4645a1.js";import{C as He,B as Ke,L as Qe}from"./LeftArrowSvg-33de1f77.js";import{R as q}from"./ReviewDetail-e153ac81.js";import{am as Ve,r as N,A as Ge}from"./ScrollToTop-c580bcc5.js";import{n as te,k as Je}from"./MainLayout-8e30f7a1.js";import{T as g}from"./TextInput-5e33d81a.js";import{C as ee}from"./CustomSelect-7c456a84.js";import{c as We,a as p}from"./index.esm-a02d8098.js";import{i as Xe}from"./isAdmin-12ed729d.js";import"./CustomInput-13a72ddb.js";import"./index.esm-be4af3d3.js";import"./index-933b78c2.js";const se=({id:b,title:l,labelImage:c,checked:m,name:a,customStyle:o,change:f})=>e.jsx("div",{className:"flex justify-between w-full gap-3 p-4",children:e.jsx(N.Radio,{id:b,onChange:x=>f(x),icon:e.jsx(te,{className:"w-[18px] h-[18px]"}),className:"border border-[#D9D9D9] bg-white p-0 w-[18px] h-[18px]",ripple:!1,name:a,label:e.jsx("div",{children:e.jsxs(N.Typography,{className:"font-medium tracking-032 flex items-center gap-1 text-sm text-b16",children:[c?e.jsx("img",{src:"/payment/"+c,className:"h-[23px] object-contain",alt:l}):null,e.jsx("span",{className:o,children:l})]})}),checked:m})}),$=({id:b,title:l,labelImage:c,checked:m,name:a,customStyle:o,change:f})=>e.jsx("div",{className:"flex justify-between w-full gap-3 p-4",children:e.jsx(N.Radio,{id:b,onChange:x=>f(x),icon:e.jsx(te,{className:"w-[18px] h-[18px]"}),className:"border border-[#D9D9D9] bg-white p-0 w-[18px] h-[18px]",ripple:!1,name:a,label:e.jsx("div",{children:e.jsxs(N.Typography,{className:"font-medium tracking-032 flex items-center gap-1 text-sm text-b16",children:[(c==null?void 0:c.length)>0?c.map(x=>e.jsx("img",{src:"/payment/"+x,className:"h-[23px] object-contain",alt:l})):null,e.jsx("span",{className:o,children:l})]})}),checked:m===a})}),Ye=({CardNumber:b,CardExpiry:l,CardCvc:c,handleCardPayment:m,payment:a,setPayment:o,setBilling:f,billing:x})=>{const[v,k]=t.useState(!0),P=w=>{const y=w.target;y.name==="shipping_address"&&(k(y.checked),f(!1)),y.name==="billing_address"&&(f(y.checked),k(!1))},C=w=>{o(w.target.name)};return e.jsxs("div",{children:[e.jsxs("div",{className:"space-y-14px mt-8",children:[e.jsx("h3",{className:"text-lg font-medium text-b16",children:"Payment"}),e.jsxs("p",{className:"flex gap-1 items-center text-sm text-b32 font-medium",children:[e.jsx(Ve,{className:"text-b3 text-xs"})," All transactions are secure and encrypted."]}),e.jsxs("div",{className:"[&>*]:border-b [&>*]:border-b31 [&>*:last-child]:border-0 border border-b31 rounded-md",children:[e.jsx($,{customStyle:"font-medium",change:C,name:"card",id:"credit_card",checked:a,labelImage:["visa.png","master.png","express.png"]}),e.jsxs("form",{onSubmit:m,className:"p-4 bg-[#F9F9F9] grid grid-cols-1 gap-14px",children:[e.jsx("div",{className:"relative flex justify-center items-center h-10 bg-[#F9F9F9]",children:e.jsxs("div",{className:"bg-white text-sm outline-none border-[1px] border-b31 w-full px-4 h-10 rounded-lg",children:[e.jsx(b,{className:"py-3"}),e.jsx("div",{className:"absolute right-4 top-0 h-full flex items-center",children:e.jsx("img",{className:"w-[18px] h-[18px]",src:"/svgs/lock.webp"})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-14px",children:[e.jsx("div",{className:"relative flex justify-center items-center h-10 bg-[#F9F9F9]",children:e.jsx("div",{className:"bg-white text-sm outline-none border-[1px] border-b31 w-full px-4 h-10 rounded-lg",children:e.jsx(l,{className:"py-3"})})}),e.jsx("div",{className:"relative flex justify-center items-center h-10 bg-[#F9F9F9]",children:e.jsx("div",{className:"bg-white text-sm outline-none border-[1px] border-b31 w-full px-4 h-10 rounded-lg",children:e.jsx(c,{className:"py-3"})})})]})]}),e.jsx($,{name:"paypal",change:C,checked:a,labelImage:["pay_paypal.webp"],id:"paypal"}),e.jsx($,{name:"affirm",change:C,checked:a,id:"affirm",labelImage:["affirm.webp"]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-medium text-b16",children:"Billing address"}),e.jsx("p",{className:"flex gap-1 items-center text-sm text-b32",children:"Select the address that matches your card of payment method."}),e.jsxs("div",{className:"mt-14px [&>*]:border-b [&>*]:border-b31 [&>*:last-child]:border-0 border border-b31 rounded-md",children:[e.jsx(se,{checked:v,change:P,name:"shipping_address",id:"shipping_address",title:"Same as shipping address"}),e.jsx(se,{checked:x,change:P,name:"billing_address",id:"billing_address",title:"Use a different billing address"})]})]})]})},es=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"fixed flex flex-col space-y-5 items-center justify-center top-0 w-full h-screen z-40 bg-white/80",children:[e.jsx(Ge,{className:"text-b6 text-6xl animate-spin"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Your order’s being processed."}),e.jsx("p",{className:"font-medium text-sm",children:"Please wait while we process your order."})]})]})}),hs=()=>{const[b,l]=t.useState(!1),c=Le(),m=$e(),a=u(s=>s.cart.deliveryOrders),o=u(s=>s.cart.pickupOrders);t.useEffect(()=>{(a==null?void 0:a.length)===0&&(o==null?void 0:o.length)===0&&(d("Cart is Empty","error",1e3),c("/mycart"))},[]);const{email:f,address:x,postalCode:v,city:k,country:P,province:C}=u(s=>s.order.orderInfo)||{},w=u(s=>s.cart.deliveryInfo),y=[{name:"USA",value:"us"}],ae=[{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"}],[E,re]=t.useState(""),[B,le]=t.useState(!1),[D,ie]=t.useState(""),[T,ne]=t.useState(""),[U,de]=t.useState(""),[O,oe]=t.useState(""),[M,ce]=t.useState(""),[me,ue]=t.useState("usa"),[pe,xe]=t.useState("alberta"),[F,he]=t.useState(""),[Z,fe]=t.useState(""),[ge,be]=t.useState(!1),ye=We().shape({email:p().required("Email is Required!"),firstName:p().nullable(),lastName:p().required("Last Name is Required!"),address:p().required("Address is Required!"),appartment:p().nullable(),city:p().required("City is Required!"),country:p().required("Country is Required!"),province:p().required("Province is Required!"),postalCode:p().required("Postal Code is Required!"),phone:p().required("Phone is Required!")}),[je,I]=t.useState(!1),Ne=async()=>{I(!0);const s=await CheckZip({zip:F});console.log(s),s.status==200,I(!1)};t.useEffect(()=>{F.length===5&&Ne()},[F]);const z=s=>{const{name:n,checked:h}=s.target;n==="keepUpdates"&&le(h),n==="saveAddress"&&be(h)},[_,ve]=t.useState(!1),[H,Ce]=t.useState("card"),[i,K]=t.useState(!1),[A,ss]=t.useState([]),[we,ts]=t.useState((a==null?void 0:a.length)>0?"delivery":"pickup"),Se=async()=>{try{const s={email:E,firstName:D,lastName:T,address:U,appartment:O,city:M,country:me,state:pe,postalCode:v,phone:Z};return await ye.validate(s,{abortEarly:!1}),B&&A.push(E),{status:!0,data:s}}catch(s){if(s){let n=s.errors;return K(n),n.forEach(h=>{d(h,"error",1e3)}),{status:!1}}else K([])}},r=u(s=>s.order.orderInfo),ke=u(s=>s.cart.cartId),Pe=u(s=>s.user._id),Ae=u(s=>s.user.auth),L=u(s=>s.order.orderErrors),Re=Xe(),R=Be(),Q=De(),qe=async s=>{d("Paypal Transaction!","success",1e3)},Ee=async s=>{d("Affirm Transaction!","success",1e3)},V=async s=>{const n=R.getElement(W);R.getElement(X),R.getElement(Y);const h=await Ue({price:200*100,mode:["card"],currency:"usd",description:"Neuappliance Outlet Card Transaction"});if(h)return await Q.confirmCardPayment(h.data.payIntent.client_secret,{payment_method:{card:n,billing_details:{name:`${r.firstName} ${r.lastName}`,email:r.email,address:{line1:r.address,city:r.city,country:"us",postal_code:r.postalCode,state:r.state}}}});d("Payment Intent Error!","error",1e3)},Fe=u(s=>s.order.orderNo),G=async s=>{if(L.confirm){const n=await ze({orderNo:Fe,intent:s,status:"Completed"});n.status===200?(j({confirm:!1}),d(n.data.msg,"success",1e3),l(!1)):(j({confirm:!0}),d(n.data.message,"error",1e3),l(!1))}else d("Order Already Complete!","success",1e3),l(!1)},Ie=u(s=>s.order.paymentIntent),J=async()=>{if(L.payment){if(!Q&&!R){d("Stripe Not Loaded!","error",100),l(!1);return}let s;switch(H){case"card":s=await V();break;case"paypal":await qe();break;case"affirm":await Ee();break}s!=null&&s.error?(m(j({payment:!0})),l(!1),d(s.error.type,"error",1e3)):(m(j({payment:!1})),Ze(s.paymentIntent),G(s.paymentIntent))}else G(Ie)},_e=async s=>{if(s.preventDefault(),l(!0),L.order){let n={status:!1};if(_?(r!=null&&r.keepUpdates&&A.push(r.email),n=await Se()):(r!=null&&r.keepUpdates&&A.push(r.email),n={status:!0,data:{...r}}),n.status){const h={userId:Pe,isAdmin:Re,isAuth:Ae,cartId:ke,orderType:we,shippingAddress:r,billingInfo:n.data,newsEmail:A},S=await Oe(h);console.log(S.data),S.status===200?(m(j({order:!1})),m(Me(S.data.orderNo)),J()):(m(j({order:!0})),d(S.data.message,"error",1e3),l(!1))}else d("Billing Address Not Found!","error",1e3),l(!1)}else d("Order Already Placed...","success",1e3),J()};return e.jsxs(e.Fragment,{children:["  ",b?e.jsx(es,{}):null,e.jsxs(He,{children:[e.jsx("img",{src:"/login_logo.webp",alt:""}),e.jsx(Ke,{}),e.jsxs("div",{className:"border border-b31 p-3 flex flex-col gap-3 rounded-md",children:[e.jsx(q,{title:"Contact",detail:f,textStyle:"font-medium"}),e.jsx("hr",{}),e.jsx(q,{title:"Ship to",detail:`${x},${k} ,${C}, ${P},${v}`,textStyle:"font-medium"}),e.jsx("hr",{}),(a==null?void 0:a.length)>0?e.jsx(q,{title:"Method",detail:`Home Delivery · $${w.shipping}`,subtitle:"1 to 3 Business Days",textStyle:"font-medium"}):null,(o==null?void 0:o.length)>0?e.jsx(q,{title:"Method",detail:"Self Pickup · Free",subtitle:"Always Ready!",textStyle:"font-medium"}):null]}),e.jsx(Ye,{CardNumber:W,CardExpiry:X,CardCvc:Y,handleCardPayment:V,payment:H,setPayment:Ce,billing:_,setBilling:ve}),e.jsxs("div",{className:`${_?"flex flex-col":"hidden"} duration-300  border-[1px] border-b31 rounded-md mt-3 px-4 py-4`,children:[e.jsxs("div",{className:"space-y-14px [&>*]:text-b16 [&>*]:text-sm",children:[e.jsx("h3",{className:"!text-lg font-medium text-b16",children:"Billing information"}),e.jsx(g,{width:"full",name:"Email",title:"Email",iscompulsory:"false",type:"text",value:E,onChange:s=>re(s.target.value),error:!!(i&&i.includes("Email is Required!")),errormessage:"Email is Required!",placeholder:"abc@gmail.com"}),e.jsx(N.Checkbox,{onChange:s=>z(s),checked:B,defaultChecked:!1,name:"keepUpdates",id:"keep-me-update",label:"Keep me up to date on news and exclusive offers",className:"checked:bg-black border-b31",ripple:!1})]}),e.jsxs("div",{className:"space-y-14px mt-8",children:[e.jsx("h3",{className:"text-sm font-medium text-b16",children:"Shipping address"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(g,{width:"full",name:"firstName",title:"",iscompulsory:"false",type:"text",value:D,onChange:s=>ie(s.target.value),error:!!(i&&i.includes("First Name is Required!")),errormessage:"First Name is Required!",placeholder:"First Name (optional)"}),e.jsx(g,{width:"full",name:"lastName",title:"",iscompulsory:"false",type:"text",value:T,onChange:s=>ne(s.target.value),error:!!(i&&i.includes("Last Name is Required!")),errormessage:"Last Name is Required!",placeholder:"Last Name"}),e.jsxs("div",{className:"col-span-2 space-y-3",children:[e.jsx(g,{width:"full",name:"address",title:"",iscompulsory:"false",type:"text",value:U,onChange:s=>de(s.target.value),error:!!(i&&i.includes("Address is Required!")),errormessage:"Address is Required!",placeholder:"Address"}),e.jsx(g,{width:"full",name:"appartment",title:"",iscompulsory:"false",type:"text",value:O,onChange:s=>oe(s.target.value),error:!!(i&&i.includes("Apartment, suite is Required!")),errormessage:"Apartment, suite is Required!",placeholder:"Apartment, suite, etc. (optional)"}),e.jsx(g,{width:"full",name:"city",title:"",iscompulsory:"false",type:"text",value:M,onChange:s=>ce(s.target.value),error:!!(i&&i.includes("City is Required!")),errormessage:"City is Required!",placeholder:"City"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-14px",children:[e.jsx(ee,{setState:ue,id:"country_region",label:"Country / region",Options:y}),e.jsx(ee,{setState:xe,id:"province",label:"Province",Options:ae}),e.jsxs("div",{className:"relative  col-span-2 md:col-span-1 [&>*]:h-full",children:[je?e.jsx("div",{className:"absolute flex rounded-lg items-center w-full justify-end px-2",children:e.jsx("img",{src:"/loader-bg.gif",className:"w-4 h-4"})}):null,e.jsx(g,{width:"full",name:"postalCode",title:"",iscompulsory:"false",type:"text",value:v,onChange:s=>he(s.target.value),error:!!(i&&i.includes("Postal Code is Required!")),errormessage:"Postal Code is Required!",placeholder:"Postal Code"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{width:"full",name:"phone",title:"",iscompulsory:"false",type:"text",value:Z,onChange:s=>fe(s.target.value),error:!!(i&&i.includes("Phone is Required!")),errormessage:"Phone is Required!",placeholder:"Phone"}),e.jsx("div",{className:"absolute right-3 top-3",children:e.jsx(Je,{className:"text-2xl text-b3"})})]}),e.jsx("div",{className:"[&>*]:text-b16 [&>*]:text-sm",children:e.jsx(N.Checkbox,{onChange:s=>z(s),id:"save-information",name:"saveAddress",checked:ge,defaultChecked:!1,label:"Save this information for next time",className:"checked:bg-black border-b31",ripple:!1})})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center w-full mt-5",children:[e.jsxs(Te,{to:"/mycart/shipping",className:"flex gap-1 items-center",children:[e.jsx(Qe,{}),e.jsx("span",{className:"text-sm font-medium text-b3",children:"Return to shipping"})]}),e.jsx("button",{type:"button",onClick:_e,className:"flex space-x-1 cursor-pointer py-3 px-6 text-xs rounded-lg bg-b3 text-white",children:e.jsx("span",{children:"Pay Now"})})]})]})]})};export{hs as default};
