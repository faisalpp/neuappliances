import{r as a,j as e,bP as xe,by as o,n as b,a$ as U,bQ as he,b8 as fe,u as ge,a2 as be,a3 as v,bG as ye,L as je,z as I}from"./index-300c0d14.js";import{C as Ne,B as ve,L as Ce}from"./LeftArrowSvg-61fcae6b.js";import{R as C}from"./ReviewDetail-72a32b8e.js";import{C as M}from"./CustomSelect-afa99e91.js";import{c as Se,a as S}from"./index.esm-b1e369d4.js";import"./CustomInput-462abcf6.js";const T=({id:c,title:n,labelImage:d,checked:m,name:t,customStyle:u,change:i})=>e.jsx("div",{className:"flex justify-between w-full gap-3 p-4",children:e.jsx(b.Radio,{id:c,onChange:x=>i(x),icon:e.jsx(U,{className:"w-[18px] h-[18px]"}),className:"border border-[#D9D9D9] bg-white p-0 w-[18px] h-[18px]",ripple:!1,name:t,label:e.jsx("div",{children:e.jsxs(b.Typography,{className:"font-medium tracking-032 flex items-center gap-1 text-sm text-b16",children:[d?e.jsx("img",{src:"/payment/"+d,className:"h-[23px] object-contain",alt:n}):null,e.jsx("span",{className:u,children:n})]})}),checked:m})}),D=({id:c,title:n,labelImage:d,checked:m,name:t,customStyle:u,change:i})=>e.jsx("div",{className:"flex justify-between w-full gap-3 p-4",children:e.jsx(b.Radio,{id:c,onChange:x=>i(x),icon:e.jsx(U,{className:"w-[18px] h-[18px]"}),className:"border border-[#D9D9D9] bg-white p-0 w-[18px] h-[18px]",ripple:!1,name:t,label:e.jsx("div",{children:e.jsxs(b.Typography,{className:"font-medium tracking-032 flex items-center gap-1 text-sm text-b16",children:[d?e.jsx("img",{src:"/payment/"+d,className:"h-[23px] object-contain",alt:n}):null,e.jsx("span",{className:u,children:n})]})}),checked:m===t})}),we=({payment:c,setPayment:n,setBilling:d,billing:m,card:t,setCard:u,cardErrors:i})=>{const[x,j]=a.useState(!0),N=r=>{const p=r.target;p.name==="shipping_address"&&(j(p.checked),d(!1)),p.name==="billing_address"&&(d(p.checked),j(!1))},y=r=>{n(r.target.name)},w=r=>r.replace(/\s/g,"").slice(0,16).replace(/\d{4}(?!$)/g,"$& "),R=r=>{const p=r.replace(/[^0-9]/g,"").slice(0,6);let f="";for(let g=0;g<p.length;g+=2)g!==0&&(f+="/"),f+=p.substr(g,2);return f};return e.jsxs("div",{children:[e.jsxs("div",{className:"space-y-14px mt-8",children:[e.jsx("h3",{className:"text-lg font-medium text-b16",children:"Payment"}),e.jsxs("p",{className:"flex gap-1 items-center text-sm text-b32 font-medium",children:[e.jsx(xe,{className:"text-b3 text-xs"})," All transactions are secure and encrypted."]}),e.jsxs("div",{className:"[&>*]:border-b [&>*]:border-b31 [&>*:last-child]:border-0 border border-b31 rounded-md",children:[e.jsx(D,{customStyle:"font-medium",change:y,name:"card_payment",id:"credit_card",title:"Credit card",checked:c}),e.jsxs("div",{className:"p-4 bg-[#F9F9F9] grid grid-cols-1 gap-14px",children:[e.jsx(o,{icon:"lock.webp",width:"full",name:"cardNumber",iscompulsory:"false",type:"text",value:w(t.cardNo),onChange:r=>u({...t,cardNo:t.cardNo.length>15?t.cardNo.replace(/\s/g,"").slice(0,16):r.target.value.replace(/\s/g,"").slice(0,16)}),error:!!(i&&i.includes("Card Number is Required!")),errormessage:"Card Number is Required!",placeholder:"Card number"}),e.jsx(o,{width:"full",name:"cardName",iscompulsory:"false",type:"text",value:t.name,onChange:r=>u({...t,name:r.target.value}),error:!!(i&&i.includes("Card Holder Name is Required!")),errormessage:"Card Holder Name is Required!",placeholder:"Name on card"}),e.jsxs("div",{className:"grid grid-cols-2 gap-14px",children:[e.jsx(o,{width:"full",name:"expDate",iscompulsory:"false",type:"text",value:t.expDate,onChange:r=>u({...t,expDate:R(r.target.value)}),error:!!(i&&i.includes("Card Expiry Date is Required!")),errormessage:"Card Expiry Date is Required!",placeholder:"Expiration date (MM / YY)"}),e.jsx(o,{icon:"question-fill.webp",width:"full",name:"code",iscompulsory:"false",type:"text",value:t.code,onChange:r=>u({...t,code:t.code.length>6?t.code:r.target.value}),error:!!(i&&i.includes("Security Code is Required!")),errormessage:"Security Code is Required!",placeholder:"Security code"})]})]}),e.jsx(D,{name:"paypal_payment",change:y,checked:c,labelImage:"pay_paypal.webp",id:"paypal"}),e.jsx(D,{name:"affirm_payment",change:y,checked:c,id:"affirm",labelImage:"affirm.webp"})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-medium text-b16",children:"Billing address"}),e.jsx("p",{className:"flex gap-1 items-center text-sm text-b32",children:"Select the address that matches your card of payment method."}),e.jsxs("div",{className:"mt-14px [&>*]:border-b [&>*]:border-b31 [&>*:last-child]:border-0 border border-b31 rounded-md",children:[e.jsx(T,{checked:x,change:N,name:"shipping_address",id:"shipping_address",title:"Same as shipping address"}),e.jsx(T,{checked:m,change:N,name:"billing_address",id:"billing_address",title:"Use a different billing address"})]})]})]})},Re=()=>e.jsxs("div",{className:"fixed flex flex-col space-y-5 items-center justify-center top-0 w-full h-screen z-40 bg-white/80",children:[e.jsx(he,{className:"text-b6 text-6xl animate-spin"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Your order’s being processed."}),e.jsx("p",{className:"font-medium text-sm",children:"Please wait while we process your order."})]})]}),ke="",qe=fe.create({baseURL:ke,headers:{"Content-Type":"application/json"}}),Pe=async c=>{let n;try{n=await qe.post("/api/user/process-order",c,{validateStatus:()=>!0})}catch(d){return d}return n},Oe=()=>{const[c,n]=a.useState(!1),d=ge();be();const m=v(s=>s.cart.deliveryOrders),t=v(s=>s.cart.pickupOrders);m.length===0&&t.length===0&&d("/mycart");const{email:u,address:i,postalCode:x,city:j,country:N,province:y}=v(s=>s.order.orderInfo),w=v(s=>s.cart.deliveryInfo),R=[{name:"USA",value:"usa"}],r=[{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"},{name:"Alberta",value:"alberta"}],[p,f]=a.useState(""),[g,Ae]=a.useState(!1),[B,O]=a.useState(""),[H,Y]=a.useState(""),[De,z]=a.useState(""),[Q,Z]=a.useState(""),[K,G]=a.useState(""),[_e,V]=a.useState("USA"),[$e,J]=a.useState("Alberta"),[k,W]=a.useState(""),[X,ee]=a.useState(""),[se,Le]=a.useState(!1),[l,Ee]=a.useState(!1),[te,q]=a.useState(!1),ae=async()=>{q(!0);const s=await CheckZip({zip:k});console.log(s),s.status==200,q(!1)};a.useEffect(()=>{k.length===5&&ae()},[k]);const[_,re]=a.useState(!1),[P,le]=a.useState("card_payment"),[$,ie]=a.useState({cardNo:"",name:"",expDate:"",code:""}),[ne,L]=a.useState([]),de=Se().shape({cardNo:S().matches(/^\d{16}$/,"Must be exactly 16 digits").required("Card Number is Required!"),name:S().required("Card Holder Name is Required!"),expDate:S().required("Card Expiry Date is Required!"),code:S().required("Security Code is Required!")}),[oe,A]=a.useState(null),ce=async()=>{try{return await de.validate($,{abortEarly:!1}),A("card"),!0}catch(s){if(s){let h=s.errors;return L(h),h.forEach(E=>{I(E,"error",1e3)}),!1}else return L([]),!1}},me=async()=>(A("affirm"),!0),ue=async()=>(A("paypal"),!0),pe=async s=>{s.preventDefault(),n(!0),console.log(P);let h=!1;switch(P){case"card_payment":h=await ce();break;case"affirm_payment":h=await me();break;case"paypal_payment":h=await ue();break}if(h){const F=await Pe({paymentInfo:oe});console.log(F),F.status===200?(n(!1),d("/mycart/order-success")):(I("Order Processing Error!","error",1e3),n(!1))}};return e.jsxs(e.Fragment,{children:["  ",c?e.jsx(Re,{}):e.jsxs(Ne,{children:[e.jsx("img",{src:"/login_logo.webp",alt:""}),e.jsx(ve,{}),e.jsxs("div",{className:"border border-b31 p-3 flex flex-col gap-3 rounded-md",children:[e.jsx(C,{title:"Contact",detail:u,textStyle:"font-medium"}),e.jsx("hr",{}),e.jsx(C,{title:"Ship to",detail:`${i},${j} ,${y}, ${N},${x}`,textStyle:"font-medium"}),e.jsx("hr",{}),(m==null?void 0:m.length)>0?e.jsx(C,{title:"Method",detail:`Home Delivery · $${w.shipping}`,subtitle:"1 to 3 Business Days",textStyle:"font-medium"}):null,(t==null?void 0:t.length)>0?e.jsx(C,{title:"Method",detail:"Self Pickup · Free",subtitle:"Always Ready!",textStyle:"font-medium"}):null]}),e.jsx(we,{card:$,setCard:ie,cardErrors:ne,payment:P,setPayment:le,billing:_,setBilling:re}),e.jsxs("div",{className:`${_?"flex flex-col":"hidden"} duration-300  border-[1px] border-b31 rounded-md mt-3 px-2 py-2`,children:[e.jsxs("div",{className:"space-y-14px [&>*]:text-b16 [&>*]:text-sm",children:[e.jsx("h3",{className:"text-sm font-medium text-b16",children:"Billing information"}),e.jsx(o,{width:"full",name:"Email",title:"Email",iscompulsory:"false",type:"text",value:p,onChange:s=>f(s.target.value),error:!!(l&&l.includes("Email is Required!")),errormessage:"Email is Required!",placeholder:"abc@gmail.com"}),e.jsx(b.Checkbox,{onChange:s=>handleCheckbox(s),checked:g,defaultChecked:!1,name:"keepUpdates",id:"keep-me-update",label:"Keep me up to date on news and exclusive offers",className:"checked:bg-black border-b31",ripple:!1})]}),e.jsxs("div",{className:"space-y-14px mt-8",children:[e.jsx("h3",{className:"text-lg font-medium text-b16",children:"Shipping address"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(o,{width:"full",name:"firstName",title:"",iscompulsory:"false",type:"text",value:B,onChange:s=>O(s.target.value),error:!!(l&&l.includes("First Name is Required!")),errormessage:"First Name is Required!",placeholder:"First Name (optional)"}),e.jsx(o,{width:"full",name:"lastName",title:"",iscompulsory:"false",type:"text",value:H,onChange:s=>Y(s.target.value),error:!!(l&&l.includes("Last Name is Required!")),errormessage:"Last Name is Required!",placeholder:"Last Name"}),e.jsxs("div",{className:"col-span-2 space-y-3",children:[e.jsx(o,{width:"full",name:"address",title:"",iscompulsory:"false",type:"text",value:i,onChange:s=>z(s.target.value),error:!!(l&&l.includes("Address is Required!")),errormessage:"Address is Required!",placeholder:"Address"}),e.jsx(o,{width:"full",name:"appartment",title:"",iscompulsory:"false",type:"text",value:Q,onChange:s=>Z(s.target.value),error:!!(l&&l.includes("Apartment, suite is Required!")),errormessage:"Apartment, suite is Required!",placeholder:"Apartment, suite, etc. (optional)"}),e.jsx(o,{width:"full",name:"city",title:"",iscompulsory:"false",type:"text",value:K,onChange:s=>G(s.target.value),error:!!(l&&l.includes("City is Required!")),errormessage:"City is Required!",placeholder:"City"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-14px",children:[e.jsx(M,{setState:V,id:"country_region",label:"Country / region",Options:R}),e.jsx(M,{setState:J,id:"province",label:"Province",Options:r}),e.jsxs("div",{className:"relative  col-span-2 md:col-span-1 [&>*]:h-full",children:[te?e.jsx("div",{className:"absolute flex rounded-lg items-center w-full justify-end px-2",children:e.jsx("img",{src:"/loader-bg.gif",className:"w-4 h-4"})}):null,e.jsx(o,{width:"full",name:"postalCode",title:"",iscompulsory:"false",type:"text",value:x,onChange:s=>W(s.target.value),error:!!(l&&l.includes("Postal Code is Required!")),errormessage:"Postal Code is Required!",placeholder:"Postal Code"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{width:"full",name:"phone",title:"",iscompulsory:"false",type:"text",value:X,onChange:s=>ee(s.target.value),error:!!(l&&l.includes("Phone is Required!")),errormessage:"Phone is Required!",placeholder:"Phone"}),e.jsx("div",{className:"absolute right-3 top-3",children:e.jsx(ye,{className:"text-2xl text-b3"})})]}),e.jsx("div",{className:"[&>*]:text-b16 [&>*]:text-sm",children:e.jsx(b.Checkbox,{onChange:s=>handleCheckbox(s),id:"save-information",name:"saveAddress",checked:se,defaultChecked:!1,label:"Save this information for next time",className:"checked:bg-black border-b31",ripple:!1})})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center w-full mt-5",children:[e.jsxs(je,{to:"/mycart/shipping",className:"flex gap-1 items-center",children:[e.jsx(Ce,{}),e.jsx("span",{className:"text-sm font-medium text-b3",children:"Return to shipping"})]}),e.jsx("button",{type:"button",onClick:s=>pe(s),className:"py-3 px-6 text-xs rounded-lg bg-b3 text-white",children:"Pay Now"})]})]})]})};export{Oe as default};
